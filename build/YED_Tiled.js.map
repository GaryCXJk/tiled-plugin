{"version":3,"sources":["webpack:///webpack/bootstrap b86d1ea3ec600b03790e","webpack:///./src/TiledTilemap.js","webpack:///./src/index.js","webpack:///./src/Game_Player.js","webpack:///./src/Sprite_Character.js","webpack:///./src/Spriteset_Map.js","webpack:///./src/TilesetManager.js","webpack:///./src/TiledTileLayer.js","webpack:///./src/TiledTileShader.js","webpack:///./src/AlphaFilter.js","webpack:///./src/DataManager.js","webpack:///./src/ImageManager.js","webpack:///./src/TiledManager.js","webpack:///./src/Sprite_TiledPriorityTile.js","webpack:///./src/Game_Map.js","webpack:///./src/Game_CharacterBase.js"],"names":["TiledTilemap","tiledData","_tiledData","_layers","_priorityTiles","_priorityTilesCount","setupTiled","_setupSize","_setupAnim","width","_width","height","_height","margin","_margin","tileCols","Math","ceil","_tileWidth","tileRows","_tileHeight","tilewidth","tileheight","_layerWidth","_layerHeight","_mapWidth","_mapHeight","_animFrame","_animDuration","id","_needsRepaint","parameters","PluginManager","useSquareShader","Number","hasOwnProperty","layers","layerData","zIndex","type","properties","parseInt","collision","toLevel","regionId","tileFlags","layer","layerId","spriteId","Sprite","_counter","alpha","opacity","transition","isShown","TiledManager","checkLayerHidden","transitionStep","minAlpha","min","minimumOpacity","push","addChild","_createPriorityTiles","pluginParams","size","Array","keys","x","sprite","Sprite_TiledPriorityTile","z","hide","renderer","bitmaps","map","_baseTexture","PIXI","Texture","setBitmaps","_updateAnim","needRefresh","key","refresh","startX","startY","ox","oy","roundPixels","floor","origin","y","offsetX","offsetx","offsetY","offsety","position","origX","origY","clear","_paintTiles","_paintObjectLayers","length","visible","_paintTilesLayer","objects","obj","gid","tileId","textureId","_getTextureId","dx","dy","positionHeight","_paintPriorityTile","_paintTile","mx","my","horizontalWrap","mod","verticalWrap","tilePosition","data","rectLayer","children","tileset","tilesets","w","h","columns","rId","_getAnimTileId","firstgid","ux","uy","_isPriorityTile","tileproperties","addRect","anchor","bitmap","setFrame","priority","_getPriority","_getZIndex","show","tilecount","tilesData","tiles","animation","frame","duration","tileid","playerZIndex","level","layerIds","hideOnLevel","removeChild","forEach","indexOf","hiddenData","hasHideProperties","hideLayer","a","b","val","ShaderTilemap","addListener","Game_Player","options","d","$gameParty","members","actor","checkFloorEffect","moveStraight","addHideFunction","$gameMap","$gamePlayer","hideOnRegion","hideOnRegions","split","String","regionIds","regions","filter","region","$gameSwitches","value","hideOnSwitch","showOnSwitch","addFlag","_checkEventTriggerHere","prototype","checkEventTriggerHere","triggers","call","_checkMapLevelChangingHere","checkMapLevelChanging","_update","Sprite_Character","update","locationHeight","_character","_createTilemap","Spriteset_Map","createTilemap","isTiledMap","_tilemap","isLoopHorizontal","isLoopVertical","loadTileset","_baseSprite","_loadTileset","i","ImageManager","loadParserTileset","image","refreshTileset","_tileset","_updateHideOnLevel","_updateHideOnSpecial","updateTileset","currentMapLevel","hideOnSpecial","TilesetManager","Error","window","_getFilename","path","paths","_getRealPath","getTileset","realPath","callback","xhr","XMLHttpRequest","open","overrideMimeType","onreadystatechange","readyState","status","responseText","JSON","parse","send","TiledTileLayer","useSquare","texPerChild","gl","tiledTileShader","plugins","tilemap","maxTextures","max","shader","setObjectRenderer","bindShader","_globalMat","Matrix","_activeRenderTarget","projectionMatrix","copy","append","worldTransform","uniforms","toArray","shadowColor","tempScale","_tempScale","ps","pointScale","projectionScale","abs","resolution","af","animationFrame","tileAnim","renderWebGL","CompositeRectTileLayer","GLBuffer","glCore","VertexArrayObject","squareShaderFrag","squareShaderVert","rectShaderFrag","rectShaderVert","TiledTileShader","vert","frag","shaderGenerator","generateFragmentSrc","vertSize","vertPerQuad","anim","stride","fillSamplers","vb","createVao","addIndex","indexBuffer","addAttribute","attributes","aVertexPosition","FLOAT","aTextureCoord","aFrame","aAnim","aTextureId","TilemapShader","fragmentSrc","filters","AlphaFilter","glShaderKey","uAlpha","Filter","DataManager","_tempTiledData","_tiledLoaded","_loadMapData","loadMapData","mapId","loadTiledMapData","unloadTiledMapData","idx","tiledLoaded","tilesRequired","source","realTileset","Object","assign","returnTileset","_isMapLoaded","isMapLoaded","defaultLoaded","hue","loadEmptyBitmap","filename","loadNormalBitmap","loadParserParallax","_listeners","_hideFunctions","_hideIgnoreFunctions","collisions","levelChanges","_tileFlags","_tileFlagIndex","objectName","listener","recursive","name","triggerListener","object","constructor","top","proto","__proto__","ignore","flagIds","flagId","getFlag","getFlagNames","getFlagLocation","flag","bit","group","initialize","apply","arguments","create","Sprite_Base","updateVisibility","visibility","_transition","_baseAlpha","_minAlpha","_isShown","_transitionPhase","defineProperty","Game_Map","get","configurable","varID","_currentMapLevel","$gameVariables","set","setValue","_setup","setup","_collisionMap","_arrowCollisionMap","_regions","_mapLevelChange","_positionHeightChange","_collisionMapLayers","_arrowCollisionMapLayers","_regionsLayers","_mapLevelChangeLayers","_positionHeightChangeLayers","_tileFlagsLayers","$dataMap","_setupTiled","_tiledInitialized","_refreshList","character","refreshBushDepth","isTiledInitialized","setRefreshDepth","_initializeMapLevel","_setupCollision","_setupRegion","_setupMapLevelChange","_setupTileFlags","_setupTiledEvents","_initializeMapLevelData","dataTypes","defaultData","dataType","defaultValue","typeData","_setupCollisionFull","_setupCollisionArrow","halfWidth","halfHeight","isHalfTile","realX","ids","_getTileset","tileData","collisionUpLeft","collisionUpRight","collisionDownLeft","collisionDownRight","arrowImpassable","arrowCollisionMap","realBit","arrowImpassableDown","arrowImpassableLeft","arrowImpassableRight","arrowImpassableUp","regionMap","regionOffset","levelChangeMap","_setupPositionHeightChange","positionHeightChangeMap","floorHeight","tileFlagMap","_getTileFlags","_combineFlags","flags","flagNames","property","prop","slice","toUpperCase","target","eventId","event","_events","tileWidth","tileHeight","locate","_tiledProperties","toLowerCase","_regionId","allIds","index","regionLayer","regionValue","main","regionValues","hideData","_checkPassage","checkPassage","render","arrows","arrowLayer","arrowValue","renderPassage","getPassageLayers","_isPassable","isPassable","collisionMap","collisionLayer","collisionValue","renderIsPassable","getIsPassableLayers","mapLevelChange","mapLevelChangeLayer","mapLevelChangeValue","checkPositionHeight","positionHeightChange","positionHeightChangeLayer","positionHeightChangeValue","getTileFlags","tileFlagsLayer","tileFlagsValue","renderTileFlags","checkHasTileFlag","renderHasTileFlag","_isBoatPassable","isBoatPassable","renderIsBoatPassable","_isShipPassable","isShipPassable","renderIsShipPassable","_isAirshipLandOk","isAirshipLandOk","renderIsAirshipLandOk","_isLadder","isLadder","isValid","renderIsLadder","_isBush","isBush","renderIsBush","_isCounter","isCounter","renderIsCounter","_isDamageFloor","isDamageFloor","renderIsDamageFloor","isSlipperyFloor","renderIsSlipperyFloor","getLayerProperties","ignoreHidden","layerProperties","getTileProperties","tileProperties","props","Game_CharacterBase","screenZ","_priorityType","_distancePerFrame","distancePerFrame","distance","_refreshBushDepth","_bushDepth","_updateMove","updateMove","hori","_realX","_x","_realY","_y","isMoving","newLocationHeight","_locationHeight"],"mappings":"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","file":"YED_Tiled.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b86d1ea3ec600b03790e","import TiledTileLayer from \"./TiledTileLayer\";\r\n\r\nexport class TiledTilemap extends ShaderTilemap {\r\n    initialize(tiledData) {\r\n        this._tiledData = {};\r\n        this._layers = [];\r\n        this._priorityTiles = [];\r\n        this._priorityTilesCount = 0;\r\n        this.tiledData = tiledData;\r\n        super.initialize();\r\n        this.setupTiled();\r\n    }\r\n\r\n    get tiledData() {\r\n        return this._tiledData;\r\n    }\r\n\r\n    set tiledData(val) {\r\n        this._tiledData = val;\r\n        this.setupTiled();\r\n    }\r\n\r\n    setupTiled() {\r\n        this._setupSize();\r\n        this._setupAnim();\r\n    }\r\n\r\n    _setupSize() {\r\n        let width = this._width;\r\n        let height = this._height;\r\n        let margin = this._margin;\r\n        let tileCols = Math.ceil(width / this._tileWidth) + 1;\r\n        let tileRows = Math.ceil(height / this._tileHeight) + 1;\r\n        this._tileWidth = this.tiledData.tilewidth;\r\n        this._tileHeight = this.tiledData.tileheight;\r\n        this._layerWidth = tileCols * this._tileWidth;\r\n        this._layerHeight = tileRows * this._tileHeight;\r\n        this._mapWidth = this.tiledData.width;\r\n        this._mapHeight = this.tiledData.height;\r\n    }\r\n\r\n    _setupAnim() {\r\n        this._animFrame = {};\r\n        this._animDuration = {};\r\n    }\r\n\r\n    _createLayers() {\r\n        let id = 0;\r\n        this._needsRepaint = true;\r\n\r\n        let parameters = PluginManager.parameters('ShaderTilemap');\r\n        let useSquareShader = Number(parameters.hasOwnProperty('squareShader') ? parameters['squareShader'] : 1);\r\n\r\n        for (let layerData of this.tiledData.layers) {\r\n            let zIndex = 0;\r\n            if (layerData.type != \"tilelayer\") {\r\n                id++;\r\n                continue;\r\n            }\r\n\r\n            if (!!layerData.properties && !!layerData.properties.zIndex) {\r\n                zIndex = parseInt(layerData.properties.zIndex);\r\n            }\r\n\r\n            if (!!layerData.properties && !!layerData.properties.collision) {\r\n                id++;\r\n                continue;\r\n            }\r\n\r\n            if (!!layerData.properties && !!layerData.properties.toLevel) {\r\n                id++;\r\n                continue;\r\n            }\r\n\r\n            if (!!layerData.properties && !!layerData.properties.regionId) {\r\n                id++;\r\n                continue;\r\n            }\r\n\r\n            if (!!layerData.properties && layerData.properties.tileFlags === 'hide') {\r\n                id++;\r\n                continue;\r\n            }\r\n\r\n            let layer = new TiledTileLayer(zIndex, [], useSquareShader);\r\n            layer.layerId = id; // @dryami: hack layer index\r\n            layer.spriteId = Sprite._counter++;\r\n            layer.alpha = layerData.opacity;\r\n            if(!!layerData.properties && layerData.properties.transition) {\r\n                layer.transition = layerData.properties.transition\r\n                layer.isShown = !TiledManager.checkLayerHidden(layerData)[1]\r\n                layer.transitionStep = layer.isShown ? layer.transition : 0\r\n                layer.minAlpha = Math.min(layer.alpha, (layerData.properties.minimumOpacity || 0))\r\n            }\r\n            this._layers.push(layer);\r\n            this.addChild(layer);\r\n            id++;\r\n        }\r\n\r\n        this._createPriorityTiles();\r\n    }\r\n\r\n    _createPriorityTiles() {\r\n        let pluginParams = PluginManager.parameters(\"YED_Tiled\");\r\n        let size = parseInt(pluginParams[\"Priority Tiles Limit\"]);\r\n        let zIndex = parseInt(pluginParams[\"Z - Player\"]);\r\n        for (let x of Array(size).keys()) {\r\n            let sprite = new Sprite_TiledPriorityTile();\r\n            sprite.z = sprite.zIndex = zIndex;\r\n            sprite.layerId = -1;\r\n            sprite.hide();\r\n            this.addChild(sprite);\r\n            this._priorityTiles.push(sprite);\r\n        }\r\n    }\r\n\r\n    _hackRenderer(renderer) {\r\n        return renderer;\r\n    }\r\n\r\n    refreshTileset() {\r\n        var bitmaps = this.bitmaps.map(function (x) { return x._baseTexture ? new PIXI.Texture(x._baseTexture) : x; });\r\n        for (let layer of this._layers) {\r\n            layer.setBitmaps(bitmaps);\r\n        }\r\n    }\r\n\r\n    update() {\r\n        super.update();\r\n        this._updateAnim();\r\n    }\r\n\r\n    _updateAnim() {\r\n        let needRefresh = false;\r\n        for (let key in this._animDuration) {\r\n            this._animDuration[key] -= 1;\r\n            if (this._animDuration[key] <= 0) {\r\n                this._animFrame[key] += 1;\r\n                needRefresh = true;\r\n            }\r\n        }\r\n\r\n        if (needRefresh) {\r\n            this.refresh();\r\n        }\r\n    }\r\n\r\n    _updateLayerPositions(startX, startY) {\r\n        let ox = 0;\r\n        let oy = 0;\r\n        if (this.roundPixels) {\r\n            ox = Math.floor(this.origin.x);\r\n            oy = Math.floor(this.origin.y);\r\n        } else {\r\n            ox = this.origin.x;\r\n            oy = this.origin.y;\r\n        }\r\n\r\n        for (let layer of this._layers) {\r\n            let layerData = this.tiledData.layers[layer.layerId];\r\n            let offsetX = layerData.offsetx || 0;\r\n            let offsetY = layerData.offsety || 0;\r\n            layer.position.x = startX * this._tileWidth - ox + offsetX;\r\n            layer.position.y = startY * this._tileHeight - oy + offsetY;\r\n        }\r\n\r\n        for (let sprite of this._priorityTiles) {\r\n            let layerData = this.tiledData.layers[sprite.layerId];\r\n            let offsetX = layerData ? layerData.offsetx || 0 : 0;\r\n            let offsetY = layerData ? layerData.offsety || 0 : 0;\r\n            sprite.x = sprite.origX + startX * this._tileWidth - ox + offsetX + sprite.width / 2;\r\n            sprite.y = sprite.origY + startY * this._tileHeight - oy + offsetY + sprite.height;\r\n        }\r\n    }\r\n\r\n    _paintAllTiles(startX, startY) {\r\n        this._priorityTilesCount = 0;\r\n        for (let layer of this._layers) {\r\n            layer.clear();\r\n            this._paintTiles(layer, startX, startY);\r\n        }\r\n        let id = 0;\r\n        for (let layerData of this.tiledData.layers) {\r\n            if (layerData.type != \"objectgroup\") {\r\n                id++;\r\n                continue;\r\n            }\r\n            this._paintObjectLayers(id, startX, startY);\r\n            id++;\r\n        }\r\n        while (this._priorityTilesCount < this._priorityTiles.length) {\r\n            let sprite = this._priorityTiles[this._priorityTilesCount];\r\n            sprite.hide();\r\n            sprite.layerId = -1;\r\n            this._priorityTilesCount++;\r\n        }\r\n    }\r\n\r\n    _paintTiles(layer, startX, startY) {\r\n        let layerData = this.tiledData.layers[layer.layerId];\r\n\r\n        if (!layerData.visible) {\r\n            return;\r\n        }\r\n\r\n        if (layerData.type == \"tilelayer\") {\r\n            this._paintTilesLayer(layer, startX, startY);\r\n        }\r\n    }\r\n\r\n    _paintObjectLayers(layerId, startX, startY) {\r\n        let layerData = this.tiledData.layers[layerId];\r\n        let objects = layerData.objects || [];\r\n\r\n        for (let obj of objects) {\r\n            if (!obj.gid) {\r\n                continue;\r\n            }\r\n            if (!obj.visible) {\r\n                continue;\r\n            }\r\n            let tileId = obj.gid;\r\n            let textureId = this._getTextureId(tileId);\r\n            let dx = obj.x - startX * this._tileWidth;\r\n            let dy = obj.y - startY * this._tileHeight - obj.height;\r\n            let positionHeight = 0;\r\n            if(obj.properties && obj.properties.positionHeight) {\r\n                positionHeight = obj.properties.positionHeight;\r\n            }\r\n            this._paintPriorityTile(layerId, textureId, tileId, startX, startY, dx, dy, positionHeight);\r\n        }\r\n    }\r\n\r\n    _paintTilesLayer(layer, startX, startY) {\r\n        let tileCols = Math.ceil(this._width / this._tileWidth) + 1;\r\n        let tileRows = Math.ceil(this._height / this._tileHeight) + 1;\r\n\r\n        for (let y of Array(tileRows).keys()) {\r\n            for (let x of Array(tileCols).keys()) {\r\n                this._paintTile(layer, startX, startY, x, y);\r\n            }\r\n        }\r\n    }\r\n\r\n    _paintTile(layer, startX, startY, x, y) {\r\n        let mx = x + startX;\r\n        let my = y + startY;\r\n        if (this.horizontalWrap) {\r\n            mx = mx.mod(this._mapWidth);\r\n        }\r\n        if (this.verticalWrap) {\r\n            my = my.mod(this._mapHeight);\r\n        }\r\n        let tilePosition = mx + my * this._mapWidth;\r\n        let tileId = this.tiledData.layers[layer.layerId].data[tilePosition];\r\n        let rectLayer = layer.children[0];\r\n        let textureId = 0;\r\n\r\n        if (!tileId) {\r\n            return;\r\n        }\r\n\r\n        // TODO: Problem with offsets\r\n        if (mx < 0 || mx >= this._mapWidth || my < 0 || my >= this._mapHeight) {\r\n            return;\r\n        }\r\n\r\n        textureId = this._getTextureId(tileId);\r\n\r\n        let tileset = this.tiledData.tilesets[textureId];\r\n        let dx = x * this._tileWidth;\r\n        let dy = y * this._tileHeight;\r\n        let w = tileset.tilewidth;\r\n        let h = tileset.tileheight;\r\n        let tileCols = tileset.columns;\r\n        let rId = this._getAnimTileId(textureId, tileId - tileset.firstgid);\r\n        let ux = (rId % tileCols) * w;\r\n        let uy = Math.floor(rId / tileCols) * h;\r\n\r\n        if (this._isPriorityTile(layer.layerId)) {\r\n            let positionHeight = 0;\r\n            if(this.tiledData.layers[layer.layerId].properties.positionHeight) {\r\n                positionHeight+= this.tiledData.layers[layer.layerId].properties.positionHeight || 0\r\n            }\r\n            if(tileset.tileproperties &&\r\n                tileset.tileproperties[tileId - tileset.firstgid] &&\r\n                tileset.tileproperties[tileId - tileset.firstgid].positionHeight) {\r\n                positionHeight+= tileset.tileproperties[tileId - tileset.firstgid].positionHeight || 0\r\n            }\r\n            this._paintPriorityTile(layer.layerId, textureId, tileId, startX, startY, dx, dy, positionHeight);\r\n            return;\r\n        }\r\n\r\n        rectLayer.addRect(textureId, ux, uy, dx, dy, w, h);\r\n    }\r\n\r\n    _paintPriorityTile(layerId, textureId, tileId, startX, startY, dx, dy, positionHeight = 0) {\r\n        let tileset = this.tiledData.tilesets[textureId];\r\n        let w = tileset.tilewidth;\r\n        let h = tileset.tileheight;\r\n        let tileCols = tileset.columns;\r\n        let rId = this._getAnimTileId(textureId, tileId - tileset.firstgid);\r\n        let ux = (rId % tileCols) * w;\r\n        let uy = Math.floor(rId / tileCols) * h;\r\n        let sprite = this._priorityTiles[this._priorityTilesCount];\r\n        let layerData = this.tiledData.layers[layerId];\r\n        let offsetX = layerData ? layerData.offsetx || 0 : 0;\r\n        let offsetY = layerData ? layerData.offsety || 0 : 0;\r\n        let ox = 0;\r\n        let oy = 0;\r\n        if (this.roundPixels) {\r\n            ox = Math.floor(this.origin.x);\r\n            oy = Math.floor(this.origin.y);\r\n        } else {\r\n            ox = this.origin.x;\r\n            oy = this.origin.y;\r\n        }\r\n\r\n        if (this._priorityTilesCount >= this._priorityTiles.length) {\r\n            return;\r\n        }\r\n\r\n        sprite.layerId = layerId;\r\n        sprite.anchor.x = 0.5;\r\n        sprite.anchor.y = 1.0;\r\n        sprite.origX = dx;\r\n        sprite.origY = dy;\r\n        sprite.x = sprite.origX + startX * this._tileWidth - ox + offsetX + w / 2;\r\n        sprite.y = sprite.origY + startY * this._tileHeight - oy + offsetY + h;\r\n        sprite.bitmap = this.bitmaps[textureId];\r\n        sprite.setFrame(ux, uy, w, h);\r\n        sprite.priority = this._getPriority(layerId);\r\n        sprite.z = sprite.zIndex = this._getZIndex(layerId);\r\n        sprite.positionHeight = positionHeight;\r\n        sprite.show();\r\n\r\n        this._priorityTilesCount += 1;\r\n    }\r\n\r\n    _getTextureId(tileId) {\r\n        let textureId = 0;\r\n        for (let tileset of this.tiledData.tilesets) {\r\n            if (tileId < tileset.firstgid\r\n                || tileId >= tileset.firstgid + tileset.tilecount) {\r\n                textureId++;\r\n                continue;\r\n            }\r\n            break;\r\n        }\r\n        return textureId;\r\n    }\r\n\r\n    _getAnimTileId(textureId, tileId) {\r\n        let tilesData = this.tiledData.tilesets[textureId].tiles;\r\n        if (!tilesData) {\r\n            return tileId;\r\n        }\r\n        if (!tilesData[tileId]) {\r\n            return tileId;\r\n        }\r\n        if (!tilesData[tileId].animation) {\r\n            return tileId;\r\n        }\r\n        let animation = tilesData[tileId].animation;\r\n        this._animFrame[tileId] = this._animFrame[tileId] || 0;\r\n        let frame = this._animFrame[tileId];\r\n        this._animFrame[tileId] = !!animation[frame] ? frame : 0;\r\n        frame = this._animFrame[tileId];\r\n        let duration = animation[frame].duration / 1000 * 60;\r\n        this._animDuration[tileId] = this._animDuration[tileId] || duration;\r\n        if (this._animDuration[tileId] <= 0) {\r\n            this._animDuration[tileId] = duration;\r\n        }\r\n        return animation[frame].tileid;\r\n    }\r\n\r\n    _getPriority(layerId) {\r\n        let layerData = this.tiledData.layers[layerId];\r\n        if (!layerData.properties) {\r\n            return 0;\r\n        }\r\n        if (!layerData.properties.priority) {\r\n            return 0;\r\n        }\r\n        return parseInt(layerData.properties.priority)\r\n    }\r\n\r\n    _isPriorityTile(layerId) {\r\n        let pluginParams = PluginManager.parameters(\"YED_Tiled\");\r\n        let playerZIndex = parseInt(pluginParams[\"Z - Player\"]);\r\n        let zIndex = this._getZIndex(layerId);\r\n        return this._getPriority(layerId) > 0\r\n            && zIndex === playerZIndex;\r\n    }\r\n\r\n    _getZIndex(layerId) {\r\n        let layerData = this.tiledData.layers[layerId];\r\n        if (!layerData) {\r\n            return 0;\r\n        }\r\n        if (!layerData.properties || !layerData.properties.zIndex) {\r\n            return 0;\r\n        }\r\n        return parseInt(layerData.properties.zIndex);\r\n    }\r\n\r\n    hideOnLevel(level) {\r\n        let layerIds = [];\r\n        for (let layer of this._layers) {\r\n            let layerData = this.tiledData.layers[layer.layerId];\r\n            if (layerData.properties && layerData.properties.hasOwnProperty(\"hideOnLevel\")) {\r\n                if (parseInt(layerData.properties.hideOnLevel) !== level) {\r\n                    if(layer.transition) {\r\n                        /* If this layer has a transition, we'll need to tell the layer that\r\n                           it's supposed to be showing. */\r\n                           layer.isShown = true;\r\n                    }\r\n                    this.addChild(layer);\r\n                    continue;\r\n                }\r\n                /* Since the layer is supposed to be hidden, let's first let it transition if\r\n                   it has a transition fadeout. */\r\n                if(layer.transition) {\r\n                    layer.isShown = false;\r\n                    if(layer.minAlpha > 0 || layer.transitionStep > 0) {\r\n                        this.addChild(layer)\r\n                        continue;\r\n                    }\r\n                }\r\n                /* Otherwise remove the layer and hide it */\r\n                layerIds.push(layer.layerId);\r\n                this.removeChild(layer);\r\n            }\r\n        }\r\n        this._priorityTiles.forEach(sprite => {\r\n            if(layerIds.indexOf(sprite.layerId) > -1) {\r\n                sprite.visible = true;\r\n            }\r\n        })\r\n    }\r\n    \r\n    hideOnSpecial() {\r\n        for(let layer of this._layers) {\r\n            let layerData = this.tiledData.layers[layer.layerId];\r\n\t\t\tif(layerData.properties) {\r\n                let hiddenData = TiledManager.checkLayerHidden(layerData);\r\n\t\t\t\tlet hasHideProperties = hiddenData[0];\r\n                let hideLayer = hiddenData[1];\r\n                \r\n\t\t\t\t/* If the layer has a hide property, run this code.\r\n\t\t\t\t * You don't need to run it for layers that don't have any properties that would\r\n\t\t\t\t   hide this layer. */\r\n\t\t\t\tif (hasHideProperties) {\r\n\t\t\t\t\t/* If the layer isn't supposed to be hidden, add the layer to the container */\r\n\t\t\t\t\tif (!hideLayer) {\r\n                        if(layer.transition) {\r\n                            /* If this layer has a transition, we'll need to tell the layer that\r\n                               it's supposed to be showing. */\r\n                               layer.isShown = true;\r\n                        }\r\n\t\t\t\t\t\tthis.addChild(layer);\r\n\t\t\t\t\t\tcontinue;\r\n                    }\r\n                    /* Since the layer is supposed to be hidden, let's first let it transition if\r\n                       it has a transition fadeout. */\r\n                    if(layer.transition) {\r\n                        layer.isShown = false;\r\n                        if(layer.minAlpha > 0 || layer.transitionStep > 0) {\r\n                            this.addChild(layer)\r\n                            continue;\r\n                        }\r\n                    }\r\n                    /* Otherwise remove the layer and hide it */\r\n\t\t\t\t\tthis.removeChild(layer);\r\n\t\t\t\t}\r\n\t\t\t}\r\n        }\r\n    }\r\n\t\r\n    _compareChildOrder(a, b) {\r\n        if ((a.z || 0) !== (b.z || 0)) {\r\n            return (a.z || 0) - (b.z || 0);\r\n        } else if (((a.y || 0) + (a.positionHeight || 0)) !== ((b.y || 0) + (b.positionHeight || 0))) {\r\n            return ((a.y || 0) + (a.positionHeight || 0)) - ((b.y || 0) + (b.positionHeight || 0));\r\n        } else if ((a.priority || 0) !== (b.priority || 0)) {\r\n            return (a.priority || 0) - (b.priority || 0);\r\n        } else {\r\n            return a.spriteId - b.spriteId;\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/TiledTilemap.js","import \"./TilesetManager\";\r\nimport \"./DataManager\";\r\nimport \"./ImageManager\";\r\nimport \"./TiledManager\";\r\nimport \"./Sprite_TiledPriorityTile\";\r\nimport \"./AlphaFilter\";\r\nimport { TiledTilemap } from \"./TiledTilemap\";\r\nimport \"./Game_Map\";\r\nimport \"./Game_CharacterBase\";\r\nimport \"./Game_Player\";\r\nimport \"./Sprite_Character\";\r\nimport \"./Spriteset_Map\";\r\n\r\n/* INITIALIZES LISTENERS */\r\n\r\n// Add floor damage while on a slippery floor\r\nTiledManager.addListener(Game_Player, 'slipperyfloor', function(options) {\r\n    const {d} = options\r\n    $gameParty.members().forEach(actor => {\r\n        actor.checkFloorEffect();\r\n    })\r\n    this.moveStraight(d);\r\n})\r\n\r\n/* INITIALIZES HIDE FUNCTIONS */\r\n\r\nTiledManager.addHideFunction('hideOnRegion', function(layerData) {\r\n    /* Hide if player is on certain region */\r\n    let regionId = $gameMap.regionId($gamePlayer.x, $gamePlayer.y);\r\n    let hideLayer = false;\r\n    if(parseInt(layerData.properties.hideOnRegion) === regionId) {\r\n        hideLayer = true;\r\n    }\r\n    return hideLayer;\r\n}, ['regions'])\r\n\r\nTiledManager.addHideFunction('hideOnRegions', function(layerData) {\r\n    /* Hide if player is on certain region */\r\n    let regionId = $gameMap.regionId($gamePlayer.x, $gamePlayer.y);\r\n    let hideLayer = false;\r\n    if(layerData.properties.hideOnRegions.split(',').indexOf(String(regionId)) !== -1) {\r\n        hideLayer = true;\r\n    }\r\n    return hideLayer;\r\n}, ['regions'])\r\n\r\nTiledManager.addHideFunction('hideOnAnyRegions', function(layerData) {\r\n    /* Hide if player is on certain region */\r\n    let regionIds = $gameMap.regionIds($gamePlayer.x, $gamePlayer.y);\r\n    let hideLayer = false;\r\n    let regions = layerData.properties.hideOnRegions.split(',');\r\n    if(regions.filter(region => regionIds.indexOf(region) > -1).length > 0) {\r\n        hideLayer = true;\r\n    }\r\n    return hideLayer;\r\n}, ['regions'])\r\n\r\nTiledManager.addHideFunction('hideOnSwitch', function(layerData) {\r\n    /* Hide if switch is on */\r\n    let hideLayer = false;\r\n    if($gameSwitches.value(layerData.properties.hideOnSwitch)) {\r\n        hideLayer = true;\r\n    }\r\n    return hideLayer;\r\n})\r\n\r\nTiledManager.addHideFunction('showOnSwitch', function(layerData) {\r\n    /* Show if switch is on */\r\n    let hideLayer = false;\r\n    if(!$gameSwitches.value(layerData.properties.showOnSwitch)) {\r\n        hideLayer = true;\r\n    }\r\n    return hideLayer;\r\n})\r\n\r\n/* INITIALIZES FLAGS */\r\n\r\nTiledManager.addFlag('boat', 'ship', 'airship')\r\nTiledManager.addFlag('ladder', 'bush', 'counter', 'damage')\r\nTiledManager.addFlag('ice', 'autoDown', 'autoLeft', 'autoRight', 'autoUp')\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","let _checkEventTriggerHere = Game_Player.prototype.checkEventTriggerHere;\r\nGame_Player.prototype.checkEventTriggerHere = function (triggers) {\r\n    _checkEventTriggerHere.call(this, triggers);\r\n    this._checkMapLevelChangingHere();\r\n};\r\n\r\nGame_Player.prototype._checkMapLevelChangingHere = function () {\r\n    $gameMap.checkMapLevelChanging(this.x, this.y);\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Game_Player.js","let _update = Sprite_Character.prototype.update\r\nSprite_Character.prototype.update = function() {\r\n\t_update.call(this);\r\n\tthis.locationHeight = this._character.locationHeight();\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Sprite_Character.js","import { TiledTilemap } from \"./TiledTilemap\";\r\n\r\nlet _createTilemap = Spriteset_Map.prototype.createTilemap;\r\nSpriteset_Map.prototype.createTilemap = function () {\r\n    if (!$gameMap.isTiledMap()) {\r\n        _createTilemap.call(this);\r\n        return;\r\n    }\r\n    this._tilemap = new TiledTilemap($gameMap.tiledData);\r\n    this._tilemap.horizontalWrap = $gameMap.isLoopHorizontal();\r\n    this._tilemap.verticalWrap = $gameMap.isLoopVertical();\r\n    this.loadTileset();\r\n    this._baseSprite.addChild(this._tilemap);\r\n};\r\n\r\nlet _loadTileset = Spriteset_Map.prototype.loadTileset;\r\nSpriteset_Map.prototype.loadTileset = function () {\r\n    if (!$gameMap.isTiledMap()) {\r\n        _loadTileset.call(this);\r\n        return;\r\n    }\r\n\r\n    let i = 0;\r\n    for (let tileset of $gameMap.tiledData.tilesets) {\r\n        this._tilemap.bitmaps[i] = ImageManager.loadParserTileset(tileset.image, 0);\r\n        i++;\r\n    }\r\n    this._tilemap.refreshTileset();\r\n    this._tileset = $gameMap.tiledData.tilesets;\r\n};\r\n\r\nlet _update = Spriteset_Map.prototype.update;\r\nSpriteset_Map.prototype.update = function () {\r\n    _update.call(this);\r\n    this._updateHideOnLevel();\r\n    this._updateHideOnSpecial();\r\n};\r\n\r\nSpriteset_Map.prototype.updateTileset = function () {\r\n    if (this._tileset !== $gameMap.tiledData.tilesets) {\r\n        this.loadTileset();\r\n    }\r\n};\r\n\r\nSpriteset_Map.prototype._updateHideOnLevel = function () {\r\n    this._tilemap.hideOnLevel($gameMap.currentMapLevel);\r\n};\r\n\r\nSpriteset_Map.prototype._updateHideOnSpecial = function () {\r\n    if($gamePlayer && $gameMap) {\r\n        this._tilemap.hideOnSpecial();\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Spriteset_Map.js","//-----------------------------------------------------------------------------\r\n// TilesetManager\r\n//\r\n// The static class that manages the TileD tilesets.\r\n\r\nfunction TilesetManager() {\r\n    throw new Error('This is a static class');\r\n}\r\n\r\nwindow.TilesetManager = TilesetManager;\r\nTilesetManager.tilesets = {};\r\n\r\nlet _getFilename = function(path) {\r\n    let paths = path.split(\"/\");\r\n    return paths[paths.length - 1];\r\n};\r\n\r\nlet _getRealPath = function(path) {\r\n    let pluginParams = PluginManager.parameters(\"YED_Tiled\");\r\n    return pluginParams[\"Tilesets Location\"] + _getFilename(path);\r\n};\r\n\r\nTilesetManager.getTileset = function(path) {\r\n    let realPath = _getRealPath(path);\r\n    return TilesetManager.tilesets[_getFilename(path)];\r\n};\r\n\r\nTilesetManager.loadTileset = function(path, callback = false) {\r\n    let realPath = _getRealPath(path);\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open('GET', './' + realPath);\r\n    xhr.overrideMimeType('application/json');\r\n\r\n    // on success callback\r\n    xhr.onreadystatechange = function () {\r\n        if (xhr.readyState === 4) {\r\n            let tileset = false;\r\n            if (xhr.status === 200 || xhr.responseText !== \"\") {\r\n                tileset = JSON.parse(xhr.responseText);\r\n                TilesetManager.tilesets[_getFilename(path)] = tileset;\r\n            }\r\n            if(callback) {\r\n                callback(tileset);\r\n            }\r\n        }\r\n    };\r\n\r\n    // send request\r\n    xhr.send();\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/TilesetManager.js","import TiledTileShader from \"./TiledTileShader\";\r\n\r\nexport default class TiledTileLayer extends PIXI.tilemap.CompositeRectTileLayer {\r\n    constructor(zIndex, bitmaps, useSquare, texPerChild) {\r\n        super(zIndex, bitmaps, useSquare, texPerChild)\r\n    }\r\n\r\n    renderWebGL(renderer) {\r\n        var gl = renderer.gl;\r\n        if(!this.tiledTileShader) {\r\n            this.tiledTileShader = new TiledTileShader(gl, renderer.plugins.tilemap.maxTextures, this.useSquare)\r\n        }\r\n        var alpha = this.alpha;\r\n        if(this.transition) {\r\n            this.transitionStep = Math.max(0, Math.min(this.transition, this.transitionStep + (this.isShown ? 1 : -1)));\r\n            alpha-= this.minAlpha\r\n            alpha*= (this.transitionStep / this.transition)\r\n            alpha+= this.minAlpha\r\n        }\r\n        //var shader = renderer.plugins.tilemap.getShader(this.useSquare);\r\n        var shader = this.tiledTileShader;\r\n        renderer.setObjectRenderer(renderer.plugins.tilemap);\r\n        renderer.bindShader(shader);\r\n        this._globalMat = this._globalMat || new PIXI.Matrix();\r\n        renderer._activeRenderTarget.projectionMatrix.copy(this._globalMat).append(this.worldTransform);\r\n        shader.uniforms.projectionMatrix = this._globalMat.toArray(true);\r\n        shader.uniforms.shadowColor = this.shadowColor;\r\n        shader.uniforms.alpha = alpha;\r\n        if (this.useSquare) {\r\n            var tempScale = this._tempScale = (this._tempScale || [0, 0]);\r\n            tempScale[0] = this._globalMat.a >= 0 ? 1 : -1;\r\n            tempScale[1] = this._globalMat.d < 0 ? 1 : -1;\r\n            var ps = shader.uniforms.pointScale = tempScale;\r\n            shader.uniforms.projectionScale = Math.abs(this.worldTransform.a) * renderer.resolution;\r\n        }\r\n        var af = shader.uniforms.animationFrame = renderer.plugins.tilemap.tileAnim;\r\n        var layers = this.children;\r\n        for (var i = 0; i < layers.length; i++) {\r\n            layers[i].renderWebGL(renderer, this.useSquare);\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/TiledTileLayer.js","const GLBuffer = PIXI.glCore.GLBuffer;\r\nconst VertexArrayObject = PIXI.glCore.VertexArrayObject;\r\n\r\nvar squareShaderFrag = `\r\nvarying vec2 vTextureCoord;\r\nvarying float vSize;\r\nvarying float vTextureId;\r\n\r\nuniform vec4 shadowColor;\r\nuniform sampler2D uSamplers[%count%];\r\nuniform vec2 uSamplerSize[%count%];\r\nuniform vec2 pointScale;\r\nuniform float alpha;\r\n\r\nvoid main(void){\r\n   float margin = 0.5 / vSize;\r\n   vec2 pointCoord = (gl_PointCoord - 0.5) * pointScale + 0.5;\r\n   vec2 clamped = vec2(clamp(pointCoord.x, margin, 1.0 - margin), clamp(pointCoord.y, margin, 1.0 - margin));\r\n   vec2 textureCoord = pointCoord * vSize + vTextureCoord;\r\n   float textureId = vTextureId;\r\n   vec4 color;\r\n   %forloop%\r\n   gl_FragColor = color * alpha;\r\n}\r\n`\r\n\r\nvar squareShaderVert = `\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nattribute vec2 aAnim;\r\nattribute float aTextureId;\r\nattribute float aSize;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform vec2 samplerSize;\r\nuniform vec2 animationFrame;\r\nuniform float projectionScale;\r\n\r\nvarying vec2 vTextureCoord;\r\nvarying float vSize;\r\nvarying float vTextureId;\r\n\r\nvoid main(void){\r\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition + aSize * 0.5, 1.0)).xy, 0.0, 1.0);\r\n   gl_PointSize = aSize * projectionScale;\r\n   vTextureCoord = aTextureCoord + aAnim * animationFrame;\r\n   vTextureId = aTextureId;\r\n   vSize = aSize;\r\n}\r\n`\r\nvar rectShaderFrag = `\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vFrame;\r\nvarying float vTextureId;\r\nuniform vec4 shadowColor;\r\nuniform sampler2D uSamplers[%count%];\r\nuniform vec2 uSamplerSize[%count%];\r\nuniform float alpha;\r\nvoid main(void){\r\n   vec2 textureCoord = clamp(vTextureCoord, vFrame.xy, vFrame.zw);\r\n   float textureId = floor(vTextureId + 0.5);\r\n   vec4 color;\r\n   %forloop%\r\n   gl_FragColor = color * alpha;\r\n}\r\n`;\r\n\r\nvar rectShaderVert = `\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nattribute vec4 aFrame;\r\nattribute vec2 aAnim;\r\nattribute float aTextureId;\r\nuniform mat3 projectionMatrix;\r\nuniform vec2 animationFrame;\r\nvarying vec2 vTextureCoord;\r\nvarying float vTextureId;\r\nvarying vec4 vFrame;\r\nvoid main(void){\r\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n   vec2 anim = aAnim * animationFrame;\r\n   vTextureCoord = aTextureCoord + anim;\r\n   vFrame = aFrame + vec4(anim, anim);\r\n   vTextureId = aTextureId;\r\n}\r\n`;\r\nexport default class TiledTileShader extends PIXI.tilemap.TilemapShader {\r\n\r\n    constructor(gl, maxTextures, useSquare) {\r\n        let vert = useSquare ? squareShaderVert : rectShaderVert;\r\n        let frag = useSquare ? squareShaderFrag : rectShaderFrag;\r\n        super(gl,\r\n            maxTextures,\r\n            vert,\r\n            PIXI.tilemap.shaderGenerator.generateFragmentSrc(maxTextures, frag)\r\n        );\r\n        if(useSquare) {\r\n            this.vertSize = 8;\r\n            this.vertPerQuad = 1;\r\n            this.anim = 5;\r\n            this.textureId = 7;\r\n        } else {\r\n            this.vertSize = 11;\r\n            this.vertPerQuad = 4;\r\n            this.anim = 8;\r\n            this.textureId = 10;\r\n        }\r\n        this.maxTextures = maxTextures;\r\n        this.stride = this.vertSize * 4;\r\n        PIXI.tilemap.shaderGenerator.fillSamplers(this, this.maxTextures);\r\n    }\r\n\r\n    createVao(renderer, vb) {\r\n        var gl = renderer.gl;\r\n        return renderer.createVao()\r\n            .addIndex(this.indexBuffer)\r\n            .addAttribute(vb, this.attributes.aVertexPosition, gl.FLOAT, false, this.stride, 0)\r\n            .addAttribute(vb, this.attributes.aTextureCoord, gl.FLOAT, false, this.stride, 2 * 4)\r\n            .addAttribute(vb, this.attributes.aFrame, gl.FLOAT, false, this.stride, 4 * 4)\r\n            .addAttribute(vb, this.attributes.aAnim, gl.FLOAT, false, this.stride, this.anim * 4)\r\n            .addAttribute(vb, this.attributes.aTextureId, gl.FLOAT, false, this.stride, this.textureId * 4);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/TiledTileShader.js","/* A fallback implementation of AlphaFilter */\r\n\r\nconst fragmentSrc = 'varying vec2 vTextureCoord;' +\r\n'uniform sampler2D uSampler;' +\r\n'uniform float uAlpha;' +\r\n'void main(void)' +\r\n'{' +\r\n'   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;' +\r\n'}';\r\n\r\nif(!PIXI.filters.AlphaFilter) {\r\n    class AlphaFilter extends PIXI.Filter\r\n    {\r\n        /**\r\n         * @param {number} [alpha=1] Amount of alpha from 0 to 1, where 0 is transparent\r\n         */\r\n        constructor(alpha = 1.0)\r\n        {\r\n            super(\r\n                // vertex shader\r\n                null,\r\n                // fragment shader\r\n               fragmentSrc\r\n            );\r\n            this.alpha = alpha;\r\n            this.glShaderKey = 'alpha';\r\n        }\r\n        /**\r\n         * Coefficient for alpha multiplication\r\n         *\r\n         * @member {number}\r\n         * @default 1\r\n         */\r\n        get alpha()\r\n        {\r\n            return this.uniforms.uAlpha;\r\n        }\r\n        set alpha(value) // eslint-disable-line require-jsdoc\r\n        {\r\n            this.uniforms.uAlpha = value;\r\n        }\r\n    }\r\n    PIXI.filters.AlphaFilter = AlphaFilter;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/AlphaFilter.js","DataManager._tempTiledData = null;\r\nDataManager._tiledLoaded = false;\r\n\r\nlet _loadMapData = DataManager.loadMapData;\r\nDataManager.loadMapData = function (mapId) {\r\n    _loadMapData.call(this, mapId);\r\n    if (mapId > 0) {\r\n        this.loadTiledMapData(mapId);\r\n    } else {\r\n        this.unloadTiledMapData();\r\n    }\r\n};\r\n\r\nDataManager.loadTiledMapData = function (mapId) {\r\n    var xhr = new XMLHttpRequest();\r\n    let pluginParams = PluginManager.parameters(\"YED_Tiled\");\r\n    xhr.open('GET', \"./\" + pluginParams[\"Maps Location\"] + \"Map\" + mapId + \".json\");\r\n    xhr.overrideMimeType('application/json');\r\n\r\n    // on success callback\r\n    xhr.onreadystatechange = function () {\r\n        if (xhr.readyState === 4) {\r\n            if (xhr.status === 200 || xhr.responseText !== \"\") {\r\n                DataManager._tempTiledData = JSON.parse(xhr.responseText);\r\n            }\r\n            let tiledLoaded = true;\r\n            let tilesRequired = 0;\r\n            if(DataManager._tempTiledData && DataManager._tempTiledData.tilesets && DataManager._tempTiledData.tilesets.length > 0) {\r\n                for(var idx = 0; idx < DataManager._tempTiledData.tilesets.length; idx++) {\r\n                    let tileset = DataManager._tempTiledData.tilesets[idx];\r\n                    if(tileset.source) {\r\n                        let realTileset = TilesetManager.getTileset(tileset.source);\r\n                        if(realTileset) {\r\n                            DataManager._tempTiledData.tilesets[idx] = Object.assign({}, realTileset, {firstgid: DataManager._tempTiledData.tilesets[idx].firstgid});\r\n                        } else {\r\n                            tiledLoaded = false;\r\n                            tilesRequired++;\r\n                            +function(idx) {\r\n                                TilesetManager.loadTileset(tileset.source, function(returnTileset) {\r\n                                    DataManager._tempTiledData.tilesets[idx] = Object.assign({}, returnTileset, {firstgid: DataManager._tempTiledData.tilesets[idx].firstgid});\r\n                                    tilesRequired--;\r\n                                    if(tilesRequired === 0) {\r\n                                        DataManager._tiledLoaded = true;\r\n                                    }\r\n                                });\r\n                            }(idx);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            DataManager._tiledLoaded = tiledLoaded;\r\n        }\r\n    };\r\n\r\n    // set data to null and send request\r\n    this.unloadTiledMapData();\r\n    xhr.send();\r\n};\r\n\r\nDataManager.unloadTiledMapData = function () {\r\n    DataManager._tempTiledData = null;\r\n    DataManager._tiledLoaded = false;\r\n};\r\n\r\nlet _isMapLoaded = DataManager.isMapLoaded;\r\nDataManager.isMapLoaded = function() {\r\n    let defaultLoaded = _isMapLoaded.call(this);\r\n    let tiledLoaded = DataManager._tiledLoaded;\r\n\r\n    return defaultLoaded && tiledLoaded;\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/DataManager.js","ImageManager.loadParserTileset = function (path, hue) {\r\n    if (!path) {\r\n        return this.loadEmptyBitmap();\r\n    }\r\n    let paths = path.split(\"/\");\r\n    let filename = paths[paths.length - 1];\r\n    let realPath = \"img/tilesets/\" + filename;\r\n\r\n    return this.loadNormalBitmap(realPath, hue);\r\n};\r\n\r\nImageManager.loadParserParallax = function (path, hue) {\r\n    if (!path) {\r\n        return this.loadEmptyBitmap();\r\n    }\r\n    let paths = path.split(\"/\");\r\n    let filename = paths[paths.length - 1];\r\n    let realPath = \"img/parallaxes/\" + filename;\r\n\r\n    return this.loadNormalBitmap(realPath, hue);\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/ImageManager.js","//-----------------------------------------------------------------------------\r\n// TiledManager\r\n//\r\n// The static class that manages TileD data, including extensions.\r\n\r\nfunction TiledManager() {\r\n    throw new Error('This is a static class');\r\n}\r\n\r\nwindow.TiledManager = TiledManager;\r\n\r\nlet _listeners = {}\r\nlet _hideFunctions = {}\r\nlet _hideIgnoreFunctions = {\r\n    regions: [],\r\n    collisions: [],\r\n    levelChanges: [],\r\n    tileFlags: []\r\n}\r\nlet _tileFlags = {}\r\nlet _tileFlagIndex = 1;\r\n\r\nTiledManager.addListener = function(objectName, listener, callback, recursive = true) {\r\n    if(typeof objectName === 'function') {\r\n        objectName = objectName.name\r\n    }\r\n    if(!_listeners[objectName]) {\r\n        _listeners[objectName] = {}\r\n    }\r\n    if(!_listeners[objectName][listener]) {\r\n        _listeners[objectName][listener] = []\r\n    }\r\n    callback.recursive = !!recursive\r\n    _listeners[objectName][listener].push(callback)\r\n}\r\n\r\nTiledManager.triggerListener = function(object, listener, options = {}) {\r\n    let objectName = object.constructor.name\r\n    if(!_listeners[objectName] || !_listeners[objectName][listener]) {\r\n        return false\r\n    }\r\n    let top = true\r\n    let proto = object.__proto__\r\n    while(proto) {\r\n        objectName = proto.constructor.name\r\n        if(_listeners[objectName] && _listeners[objectName][listener]) {\r\n            _listeners[objectName][listener].forEach(callback => {\r\n                if(top || callback.recursive) {\r\n                    callback.call(object, options)\r\n                }\r\n            })\r\n        }\r\n        top = false\r\n        proto = proto.__proto__\r\n    }\r\n}\r\n\r\nTiledManager.addHideFunction = function(id, callback, ignore = []) {\r\n    _hideFunctions[id] = callback\r\n\r\n    ignore.forEach((type) => {\r\n        _hideIgnoreFunctions[type].push(id)\r\n    })\r\n}\r\n\r\nTiledManager.checkLayerHidden = function(layerData, ignore = []) {\r\n    if(typeof ignore === 'string') {\r\n        ignore = _hideIgnoreFunctions[ignore] || []\r\n    }\r\n    let keys = Object.keys(_hideFunctions);\r\n    let data = [false, false];\r\n    for(let idx = 0; idx < keys.length; idx++) {\r\n        if(ignore.indexOf(keys) !== -1) {\r\n            continue;\r\n        }\r\n        if(layerData.properties && layerData.properties.hasOwnProperty(keys[idx])) {\r\n            data[0] = true;\r\n            data[1] = data[1] || _hideFunctions[keys[idx]](layerData);\r\n        }\r\n        if(data[1]) {\r\n            return data;\r\n        }\r\n    }\r\n    return data;\r\n}\r\n\r\nTiledManager.hasHideProperties = function(layerData) {\r\n    return (layerData.properties && (\r\n        Object.keys(_hideFunctions).filter(key => {\r\n            return layerData.properties.hasOwnProperty(key)\r\n        }).length > 0)\r\n    );\r\n}\r\n\r\nTiledManager.addFlag = function(...flagIds) {\r\n    flagIds.forEach(flagId => {\r\n        _tileFlags[flagId] = _tileFlagIndex++;\r\n    })\r\n}\r\n\r\nTiledManager.getFlag = function(flagId) {\r\n    return _tileFlags[flagId];\r\n}\r\n\r\nTiledManager.getFlagNames = function() {\r\n    return Object.keys(_tileFlags);\r\n}\r\n\r\nTiledManager.getFlagLocation = function(flagId) {\r\n    let flag = _tileFlags[flagId]\r\n    let bit = (1 << (flag % 16)) & 0xffff;\r\n    let group = Math.floor(flag / 16);\r\n    return [group, bit];\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/TiledManager.js","//-----------------------------------------------------------------------------\r\n// Sprite_TiledPriorityTile\r\n//\r\n// The sprite for displaying a priority tile.\r\n\r\nfunction Sprite_TiledPriorityTile() {\r\n    this.initialize.apply(this, arguments);\r\n}\r\n\r\nSprite_TiledPriorityTile.prototype = Object.create(Sprite_Base.prototype);\r\nSprite_TiledPriorityTile.prototype.constructor = Sprite_TiledPriorityTile;\r\n\r\nwindow.Sprite_TiledPriorityTile = Sprite_TiledPriorityTile;\r\n\r\nSprite_TiledPriorityTile.prototype.updateVisibility = function() {\r\n    let visibility = true;\r\n    if(this.layerId > -1) {\r\n        let layer = $gameMap.tiledData.layers[this.layerId];\r\n        if(layer.properties.transition) {\r\n            if(!this._transition) {\r\n                this._transition = layer.properties.transition;\r\n                this._baseAlpha = layer.opacity;\r\n                this._minAlpha = Math.min(this._baseAlpha, (layer.properties.minimumOpacity || 0));\r\n                this._isShown = !TiledManager.checkLayerHidden(layer)[1];\r\n                this._transitionPhase = this._isShown ? this._transition : 0\r\n            } else {\r\n                this._isShown = !TiledManager.checkLayerHidden(layer)[1];\r\n                this._transitionPhase = Math.max(0, Math.min(this._transition, this._transitionPhase + (this._isShown ? 1 : -1)));\r\n            }\r\n            visibility = this._minAlpha > 0 || this._transitionPhase > 0;\r\n            this.opacity = 255 * (((this._baseAlpha - this._minAlpha) * (this._transitionPhase / this._transition)) + this._minAlpha);\r\n        }\r\n    }\r\n    this.visible = visibility;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Sprite_TiledPriorityTile.js","// Constants\r\n\r\nObject.defineProperty(Game_Map.prototype, 'tiledData', {\r\n    get: function () {\r\n        return DataManager._tempTiledData;\r\n    },\r\n    configurable: true\r\n});\r\n\r\nObject.defineProperty(Game_Map.prototype, 'currentMapLevel', {\r\n    get: function () {\r\n        let pluginParams = PluginManager.parameters(\"YED_Tiled\");\r\n        let varID = parseInt(pluginParams[\"Map Level Variable\"]);\r\n        if (!varID) {\r\n            return this._currentMapLevel;\r\n        } else {\r\n            return $gameVariables.value(varID);\r\n        }\r\n    },\r\n    set: function (value) {\r\n        let pluginParams = PluginManager.parameters(\"YED_Tiled\");\r\n        let varID = parseInt(pluginParams[\"Map Level Variable\"]);\r\n        if (!varID) {\r\n            this._currentMapLevel = value;\r\n        } else {\r\n            $gameVariables.setValue(varID, value);\r\n        }\r\n    },\r\n    configurable: true\r\n});\r\n\r\nlet _setup = Game_Map.prototype.setup;\r\nGame_Map.prototype.setup = function (mapId) {\r\n    _setup.call(this, mapId);\r\n    this._collisionMap = {};\r\n    this._arrowCollisionMap = {};\r\n    this._regions = {};\r\n    this._mapLevelChange = {};\r\n    this._positionHeightChange = {};\r\n    this._tileFlags = {};\r\n    this._collisionMapLayers = [];\r\n    this._arrowCollisionMapLayers = [];\r\n    this._regionsLayers = [];\r\n    this._mapLevelChangeLayers = [];\r\n    this._positionHeightChangeLayers = [];\r\n    this._tileFlagsLayers = [];\r\n    this._currentMapLevel = 0;\r\n    this.currentMapLevel = 0;\r\n    if (this.isTiledMap()) {\r\n        $dataMap.width = this.tiledData.width;\r\n        $dataMap.height = this.tiledData.height;\r\n        this._setupTiled();\r\n        this._tiledInitialized = true;\r\n        if(this._refreshList) {\r\n            this._refreshList.forEach(character => {\r\n                character.refreshBushDepth();\r\n            })\r\n        }\r\n    }\r\n};\r\n\r\nGame_Map.prototype.isTiledInitialized = function() {\r\n    return !!this._tiledInitialized;\r\n}\r\n\r\nGame_Map.prototype.setRefreshDepth = function(character) {\r\n    if(!this._refreshList) {\r\n        this._refreshList = [];\r\n    }\r\n    this._refreshList.push(character);\r\n}\r\n\r\nGame_Map.prototype.isTiledMap = function () {\r\n    return !!this.tiledData;\r\n};\r\n\r\nGame_Map.prototype._setupTiled = function () {\r\n    this._initializeMapLevel(0);\r\n\r\n    this._setupCollision();\r\n    this._setupRegion();\r\n    this._setupMapLevelChange();\r\n    this._setupTileFlags();\r\n    this._setupTiledEvents();\r\n};\r\n\r\nGame_Map.prototype._initializeMapLevel = function (id) {\r\n    if (!!this._collisionMap[id]) {\r\n        return;\r\n    }\r\n\r\n    this._collisionMap[id] = {};\r\n    this._arrowCollisionMap[id] = {};\r\n    this._regions[id] = {};\r\n    this._mapLevelChange[id] = {};\r\n    this._tileFlags[id] = {};\r\n    this._collisionMapLayers[id] = [];\r\n    this._arrowCollisionMapLayers[id] = [];\r\n    this._regionsLayers[id] = [];\r\n    this._mapLevelChangeLayers[id] = [];\r\n    this._tileFlagsLayers[id] = [];\r\n    this._initializeMapLevelData(id);\r\n};\r\n\r\nGame_Map.prototype._initializeMapLevelData = function(id = 0, layerId = 'main', dataTypes = false) {\r\n    let width = this.width();\r\n    let height = this.height();\r\n    let size = width * height;\r\n    \r\n    const defaultData = {\r\n        'collisionMap': 0,\r\n        'arrowCollisionMap': 1 | 2 | 4 | 8,\r\n        'regions': 0,\r\n        'mapLevelChange': -1,\r\n        'positionHeightChange': -1,\r\n        'tileFlags': 0\r\n    }\r\n\r\n    if(!dataTypes) {\r\n        dataTypes = Object.keys(defaultData);\r\n    }\r\n\r\n    for(let idx = 0; idx < dataTypes.length; idx++) {\r\n        let dataType = dataTypes[idx];\r\n        let defaultValue = defaultData[dataType];\r\n        if(!this['_' + dataType][id]) {\r\n            this['_' + dataType][id] = {};\r\n            this['_' + dataType + 'Layers'][id] = [];\r\n        }\r\n        if(!!this['_' + dataType][id][layerId]) {\r\n            continue;\r\n        }\r\n        this['_' + dataType][id][layerId] = []\r\n        let typeData = this['_' + dataType][id][layerId]\r\n        for (let x of Array(size).keys()) {\r\n            typeData.push(defaultValue);\r\n        }\r\n    }\r\n}\r\n\r\nGame_Map.prototype._setupCollision = function () {\r\n    this._setupCollisionFull();\r\n    this._setupCollisionArrow();\r\n};\r\n\r\nGame_Map.prototype._setupCollisionFull = function () {\r\n    let width = this.width();\r\n    let height = this.height();\r\n    let size = width * height;\r\n    let halfWidth = width / 2;\r\n    let halfHeight = height / 2;\r\n\r\n    if (this.isHalfTile()) {\r\n        size /= 4;\r\n    }\r\n\r\n    for (let idx = 0; idx < this.tiledData.layers.length; idx++) {\r\n        let layerData = this.tiledData.layers[idx]\r\n        if (!layerData.properties || !layerData.properties.collision) {\r\n            continue;\r\n        }\r\n\r\n        if (layerData.properties.collision !== \"full\"\r\n            && layerData.properties.collision !== \"up-left\"\r\n            && layerData.properties.collision !== \"up-right\"\r\n            && layerData.properties.collision !== \"down-left\"\r\n            && layerData.properties.collision !== \"down-right\"\r\n            && layerData.properties.collision !== \"tiles\") {\r\n            continue;\r\n        }\r\n\r\n        let level = parseInt(layerData.properties.level) || 0;\r\n        this._initializeMapLevel(level);\r\n        \r\n        let layerId = 'main';\r\n\r\n        if(TiledManager.hasHideProperties(layerData)) {\r\n            layerId = idx;\r\n            this._collisionMapLayers[level].push(idx);\r\n            this._initializeMapLevelData(level, layerId, ['collisionMap']);\r\n        }\r\n        \r\n        for (let x of Array(size).keys()) {\r\n            let realX = x;\r\n            let ids = [];\r\n            if (this.isHalfTile()) {\r\n                realX = Math.floor(x / halfWidth) * width * 2 + (x % halfWidth) * 2;\r\n            }\r\n            if (!!layerData.data[x]) {\r\n                switch(layerData.properties.collision) {\r\n                    case \"full\":\r\n                        ids.push(realX);\r\n                        if (this.isHalfTile()) {\r\n                            ids.push(realX + 1, realX + width, realX + width + 1);\r\n                        }\r\n                        break;\r\n                    case \"up-left\":\r\n                        ids.push(realX);\r\n                        break;\r\n                    case \"up-right\":\r\n                        ids.push(realX + 1);\r\n                        break;\r\n                    case \"down-left\":\r\n                        ids.push(realX + width);\r\n                        break;\r\n                    case \"down-right\":\r\n                        ids.push(realX + width + 1);\r\n                        break;\r\n                    case \"tiles\":\r\n                        let tileId = layerData.data[x];\r\n                        let tileset = this._getTileset(tileId);\r\n                        if(tileset && tileset.tileproperties) {\r\n                            let tileData = tileset.tileproperties[tileId - tileset.firstgid];\r\n                            if(tileData) {\r\n                                if(tileData.collision) {\r\n                                    ids.push(realX);\r\n                                    if (this.isHalfTile()) {\r\n                                        ids.push(realX + 1, realX + width, realX + width + 1);\r\n                                    }\r\n                                }\r\n                                if(tileData.collisionUpLeft) {\r\n                                    ids.push(realX);\r\n                                }\r\n                                if(tileData.collisionUpRight) {\r\n                                    ids.push(realX + 1);\r\n                                }\r\n                                if(tileData.collisionDownLeft) {\r\n                                    ids.push(realX + width);\r\n                                }\r\n                                if(tileData.collisionDownRight) {\r\n                                    ids.push(realX + width + 1);\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                }\r\n                for (let id of ids) {\r\n                    this._collisionMap[level][layerId][id] = 1;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nGame_Map.prototype._setupCollisionArrow = function () {\r\n    let width = this.width();\r\n    let height = this.height();\r\n    let size = width * height;\r\n    let bit = 0;\r\n    let halfWidth = width / 2;\r\n    let halfHeight = height / 2;\r\n\r\n    if (this.isHalfTile()) {\r\n        size /= 4;\r\n    }\r\n\r\n    for (let idx = 0; idx < this.tiledData.layers.length; idx++) {\r\n        let layerData = this.tiledData.layers[idx]\r\n        if (!layerData.properties || !layerData.properties.collision) {\r\n            continue;\r\n        }\r\n\r\n        if (layerData.properties.collision !== \"arrow\" && layerData.properties.collision !== \"tiles\") {\r\n            continue;\r\n        }\r\n\r\n        if (!layerData.properties.arrowImpassable && layerData.properties.collision !== \"tiles\") {\r\n            continue;\r\n        }\r\n        \r\n        if(layerData.properties.arrowImpassable) {\r\n\r\n            if (layerData.properties.arrowImpassable === \"down\") {\r\n                bit = 1;\r\n            }\r\n\r\n            if (layerData.properties.arrowImpassable === \"left\") {\r\n                bit = 2;\r\n            }\r\n\r\n            if (layerData.properties.arrowImpassable === \"right\") {\r\n                bit = 4;\r\n            }\r\n\r\n            if (layerData.properties.arrowImpassable === \"up\") {\r\n                bit = 8;\r\n            }\r\n\r\n\r\n        }\r\n\r\n        let level = parseInt(layerData.properties.level) || 0;\r\n        this._initializeMapLevel(level);\r\n        \r\n        let layerId = 'main';\r\n\r\n        if(TiledManager.hasHideProperties(layerData)) {\r\n            layerId = idx;\r\n            this._arrowCollisionMapLayers[level].push(idx);\r\n            this._initializeMapLevelData(level, layerId, ['arrowCollisionMap']);\r\n        }\r\n        \r\n        let arrowCollisionMap = this._arrowCollisionMap[level][layerId];\r\n        for (let x of Array(size).keys()) {\r\n            let realX = x;\r\n            if (this.isHalfTile()) {\r\n                realX = Math.floor(x / halfWidth) * width * 2 + (x % halfWidth) * 2;\r\n            }\r\n\r\n            if (!!layerData.data[x]) {\r\n                let realBit = bit;\r\n                if(layerData.properties.collision === \"tiles\") {\r\n                    realBit = 0;\r\n                    let tileId = layerData.data[x];\r\n                    let tileset = this._getTileset(tileId);\r\n                    if(tileset && tileset.tileproperties) {\r\n                        let tileData = tileset.tileproperties[tileId - tileset.firstgid];\r\n                        if(tileData) {\r\n                            if(tileData.arrowImpassableDown) {\r\n                                realBit+= 1;\r\n                            }\r\n                            if(tileData.arrowImpassableLeft) {\r\n                                realBit+= 2;\r\n                            }\r\n                            if(tileData.arrowImpassableRight) {\r\n                                realBit+= 4;\r\n                            }\r\n                            if(tileData.arrowImpassableUp) {\r\n                                realBit+= 8;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                arrowCollisionMap[realX] = arrowCollisionMap[realX] ^ realBit;\r\n                if (this.isHalfTile()) {\r\n                    arrowCollisionMap[realX + 1]\r\n                        = arrowCollisionMap[realX + 1] ^ realBit;\r\n                    arrowCollisionMap[realX + width]\r\n                        = arrowCollisionMap[realX + width] ^ realBit;\r\n                    arrowCollisionMap[realX + width + 1]\r\n                        = arrowCollisionMap[realX + width + 1] ^ realBit;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nGame_Map.prototype._setupRegion = function () {\r\n    let width = this.width();\r\n    let height = this.height();\r\n    let size = width * height;\r\n    let halfWidth = width / 2;\r\n    let halfHeight = height / 2;\r\n\r\n    if (this.isHalfTile()) {\r\n        size /= 4;\r\n    }\r\n\r\n    for (let idx = 0; idx < this.tiledData.layers.length; idx++) {\r\n        let layerData = this.tiledData.layers[idx]\r\n        if (!layerData.properties || !layerData.properties.regionId) {\r\n            continue;\r\n        }\r\n\r\n        let level = parseInt(layerData.properties.level) || 0;\r\n        this._initializeMapLevel(level);\r\n        \r\n        let layerId = 'main';\r\n\r\n        if(TiledManager.hasHideProperties(layerData)) {\r\n            layerId = idx;\r\n            this._regionsLayers[level].push(idx);\r\n            this._initializeMapLevelData(level, layerId, ['regions']);\r\n        }\r\n        \r\n        let regionMap = this._regions[level][layerId];\r\n\r\n        for (let x of Array(size).keys()) {\r\n            let realX = x;\r\n            if (this.isHalfTile()) {\r\n                realX = Math.floor(x / halfWidth) * width * 2 + (x % halfWidth) * 2;\r\n            }\r\n\r\n            if (!!layerData.data[x]) {\r\n                let regionId = 0;\r\n                if(layerData.properties.regionId > -1) {\r\n                    regionId = parseInt(layerData.properties.regionId);\r\n                } else {\r\n                    let tileId = layerData.data[x];\r\n                    let tileset = this._getTileset(tileId);\r\n                    if(tileset && tileset.tileproperties) {\r\n                        let tileData = tileset.tileproperties[tileId - tileset.firstgid];\r\n                        if(tileData && tileData.regionId) {\r\n                            regionId = parseInt(tileData.regionId);\r\n                        }\r\n                    }\r\n                    if(layerData.properties.regionOffset) {\r\n                        regionId+= layerData.properties.regionOffset;\r\n                    }\r\n                }\r\n                regionMap[realX] = regionId;\r\n                if (this.isHalfTile()) {\r\n                    regionMap[realX + 1] = regionId;\r\n                    regionMap[realX + width] = regionId;\r\n                    regionMap[realX + width + 1] = regionId;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nGame_Map.prototype._setupMapLevelChange = function () {\r\n    let width = this.width();\r\n    let height = this.height();\r\n    let size = width * height;\r\n    let halfWidth = width / 2;\r\n    let halfHeight = height / 2;\r\n\r\n    if (this.isHalfTile()) {\r\n        size /= 4;\r\n    }\r\n\r\n    for (let idx = 0; idx < this.tiledData.layers.length; idx++) {\r\n        let layerData = this.tiledData.layers[idx]\r\n        if (!layerData.properties || !layerData.properties.hasOwnProperty('toLevel')) {\r\n            continue;\r\n        }\r\n\r\n        let level = parseInt(layerData.properties.level) || 0;\r\n        this._initializeMapLevel(level);\r\n        let layerId = 'main';\r\n\r\n        if(TiledManager.hasHideProperties(layerData)) {\r\n            layerId = idx;\r\n            this._mapLevelChangeLayers[level].push(idx);\r\n            this._initializeMapLevelData(level, layerId, ['mapLevelChange']);\r\n        }\r\n        \r\n        let levelChangeMap = this._mapLevelChange[level][layerId];\r\n\r\n        for (let x of Array(size).keys()) {\r\n            let realX = x;\r\n            let toLevel = parseInt(layerData.properties.toLevel);\r\n            if (this.isHalfTile()) {\r\n                realX = Math.floor(x / halfWidth) * width * 2 + (x % halfWidth) * 2;\r\n            }\r\n\r\n            if (!!layerData.data[x]) {\r\n                levelChangeMap[realX] = toLevel;\r\n                if (this.isHalfTile()) {\r\n                    levelChangeMap[realX + 1] = toLevel;\r\n                    levelChangeMap[realX + width] = toLevel;\r\n                    levelChangeMap[realX + width + 1] = toLevel;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nGame_Map.prototype._setupPositionHeightChange = function () {\r\n    let width = this.width();\r\n    let height = this.height();\r\n    let size = width * height;\r\n    let halfWidth = width / 2;\r\n    let halfHeight = height / 2;\r\n\r\n    if (this.isHalfTile()) {\r\n        size /= 4;\r\n    }\r\n\r\n    for (let idx = 0; idx < this.tiledData.layers.length; idx++) {\r\n        let layerData = this.tiledData.layers[idx]\r\n        if (!layerData.properties || !layerData.properties.hasOwnProperty('floorHeight')) {\r\n            continue;\r\n        }\r\n\r\n        let level = parseInt(layerData.properties.level) || 0;\r\n        this._initializeMapLevel(level);\r\n        let layerId = 'main';\r\n\r\n        if(TiledManager.hasHideProperties(layerData)) {\r\n            layerId = idx;\r\n            this._positionHeightChangeLayers[level].push(idx);\r\n            this._initializeMapLevelData(level, layerId, ['positionHeightChange']);\r\n        }\r\n        \r\n        let positionHeightChangeMap = this._positionHeightChange[level][layerId];\r\n\r\n        for (let x of Array(size).keys()) {\r\n            let realX = x;\r\n            let toLevel = parseInt(layerData.properties.floorHeight);\r\n            if (this.isHalfTile()) {\r\n                realX = Math.floor(x / halfWidth) * width * 2 + (x % halfWidth) * 2;\r\n            }\r\n\r\n            if (!!layerData.data[x]) {\r\n                positionHeightChangeMap[realX] = toLevel;\r\n                if (this.isHalfTile()) {\r\n                    positionHeightChangeMap[realX + 1] = toLevel;\r\n                    positionHeightChangeMap[realX + width] = toLevel;\r\n                    positionHeightChangeMap[realX + width + 1] = toLevel;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nGame_Map.prototype._setupTileFlags = function() {\r\n    let width = this.width();\r\n    let height = this.height();\r\n    let size = width * height;\r\n    let halfWidth = width / 2;\r\n    let halfHeight = height / 2;\r\n\r\n    if (this.isHalfTile()) {\r\n        size /= 4;\r\n    }\r\n    \r\n    for (let idx = 0; idx < this.tiledData.layers.length; idx++) {\r\n        let layerData = this.tiledData.layers[idx]\r\n        if (!layerData.properties || !layerData.properties.tileFlags) {\r\n            continue;\r\n        }\r\n\r\n        let level = parseInt(layerData.properties.level) || 0;\r\n        this._initializeMapLevel(level);\r\n        \r\n        let layerId = 'main';\r\n\r\n        if(TiledManager.hasHideProperties(layerData)) {\r\n            layerId = idx;\r\n            this._tileFlagsLayers[level].push(idx);\r\n            this._initializeMapLevelData(level, layerId, ['tileFlags']);\r\n        }\r\n        \r\n        let tileFlagMap = this._tileFlags[level][layerId];\r\n\r\n        for (let x of Array(size).keys()) {\r\n            let realX = x;\r\n            if (this.isHalfTile()) {\r\n                realX = Math.floor(x / halfWidth) * width * 2 + (x % halfWidth) * 2;\r\n            }\r\n\r\n            if (!!layerData.data[x]) {\r\n                let tileFlags = 0;\r\n                let tileId = layerData.data[x];\r\n                let tileset = this._getTileset(tileId);\r\n                if(tileset && tileset.tileproperties) {\r\n                    let tileData = tileset.tileproperties[tileId - tileset.firstgid];\r\n                    if(tileData) {\r\n                        tileFlags = this._getTileFlags(tileData);\r\n                    }\r\n                }\r\n                tileFlagMap[realX] = this._combineFlags(tileFlagMap[realX], tileFlags);\r\n                if (this.isHalfTile()) {\r\n                    tileFlagMap[realX + 1] = this._combineFlags(tileFlagMap[realX + 1], tileFlags);\r\n                    tileFlagMap[realX + width] = this._combineFlags(tileFlagMap[realX + width], tileFlags);\r\n                    tileFlagMap[realX + width + 1] = this._combineFlags(tileFlagMap[realX + width + 1], tileFlags);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nGame_Map.prototype._getTileFlags = function(tileData) {\r\n    let flags = []\r\n    let flagNames = TiledManager.getFlagNames()\r\n    flagNames.forEach(prop => {\r\n        let property = 'flagIs' + prop.slice(0, 1).toUpperCase() + prop.slice(1)\r\n        if(tileData[property]) {\r\n            let [group, bit] = TiledManager.getFlagLocation(prop)\r\n            for(let i = flags.length; i <= group; i++) {\r\n                flags.push(0)\r\n            }\r\n            flags[group]|= bit\r\n        }\r\n    })\r\n    return flags.length > 0 ? flags : 0\r\n}\r\n\r\nGame_Map.prototype._combineFlags = function (source, target) {\r\n    source = source ? source.slice(0) : []\r\n    for(let i = 0; i < target.length; i++) {\r\n        if(!source.length <= i) {\r\n            source.push(i)\r\n        }\r\n        source[i]|= target[i];\r\n    }\r\n    return source;\r\n}\r\n\r\nGame_Map.prototype._setupTiledEvents = function () {\r\n    for (let layerData of this.tiledData.layers) {\r\n        if (layerData.type !== \"objectgroup\") {\r\n            continue;\r\n        }\r\n\r\n        for (let object of layerData.objects) {\r\n            if (!object.properties) {\r\n                continue;\r\n            }\r\n\r\n            if (!object.properties.eventId) {\r\n                continue;\r\n            }\r\n\r\n            let eventId = parseInt(object.properties.eventId);\r\n            let event = this._events[eventId];\r\n            if (!event) {\r\n                continue;\r\n            }\r\n            let x = Math.floor(object.x / this.tileWidth());\r\n            let y = Math.floor(object.y / this.tileHeight());\r\n            if (this.isHalfTile()) {\r\n                x += 1;\r\n                y += 1;\r\n            }\r\n            event.locate(x, y);\r\n\t\t\tevent._tiledProperties = object.properties;\r\n        }\r\n    }\r\n};\r\n\r\nGame_Map.prototype.isHalfTile = function () {\r\n    let pluginParams = PluginManager.parameters(\"YED_Tiled\");\r\n    return pluginParams[\"Half-tile movement\"].toLowerCase() === \"true\";\r\n};\r\n\r\nGame_Map.prototype._getTileset = function(tileId) {\r\n    for(let idx = 0; idx < this.tiledData.tilesets.length; idx++) {\r\n        let tileset = this.tiledData.tilesets[idx];\r\n        if(tileId >= tileset.firstgid && tileId < tileset.firstgid + tileset.tilecount) {\r\n            return tileset;\r\n        }\r\n    }\r\n    return null;\r\n};\r\n\r\nGame_Map.prototype.tileWidth = function () {\r\n    let tileWidth = this.tiledData.tilewidth;\r\n    if (this.isHalfTile()) {\r\n        tileWidth /= 2;\r\n    }\r\n    return tileWidth;\r\n};\r\n\r\nGame_Map.prototype.tileHeight = function () {\r\n    let tileHeight = this.tiledData.tileheight;\r\n    if (this.isHalfTile()) {\r\n        tileHeight /= 2;\r\n    }\r\n    return tileHeight;\r\n};\r\n\r\nGame_Map.prototype.width = function () {\r\n    let width = this.tiledData.width;\r\n    if (this.isHalfTile()) {\r\n        width *= 2;\r\n    }\r\n    return width;\r\n};\r\n\r\nGame_Map.prototype.height = function () {\r\n    let height = this.tiledData.height;\r\n    if (this.isHalfTile()) {\r\n        height *= 2;\r\n    }\r\n    return height;\r\n};\r\n\r\nlet _regionId = Game_Map.prototype.regionId;\r\nGame_Map.prototype.regionId = function (x, y, allIds = false) {\r\n    if (!this.isTiledMap()) {\r\n        return _regionId.call(this, x, y);\r\n    }\r\n\r\n    let index = x + this.width() * y;\r\n    let regionMap = this._regions[this.currentMapLevel];\r\n    let regionLayer = this._regionsLayers[this.currentMapLevel];\r\n    \r\n    let regionValue = regionMap.main[index];\r\n    let regionValues = [regionValue];\r\n\r\n    if(regionLayer && regionLayer.length > 0) {\r\n        for(let idx = 0; idx < regionLayer.length; idx++) {\r\n            let layerId = regionLayer[idx];\r\n            let layerData = this.tiledData.layers[layerId];\r\n            let hideData = TiledManager.checkLayerHidden(layerData, 'regions');\r\n            if(!hideData[1]) {\r\n                if(allIds) {\r\n                    regionValues.push(regionMap[layerId][index]);\r\n                } else {\r\n                    regionValue = regionMap[layerId][index];\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return allIds ? regionValues : regionValue;\r\n};\r\n\r\nGame_Map.prototype.regionIds = function (x, y) {\r\n    return this.regionId(x, y, true);\r\n}\r\n\r\nlet _checkPassage = Game_Map.prototype.checkPassage;\r\nGame_Map.prototype.checkPassage = function (x, y, bit, render = false, level = false) {\r\n    if (!this.isTiledMap()) {\r\n        return _checkPassage.call(this, x, y, d);\r\n    }\r\n    if(level === false) {\r\n        level = this._currentMapLevel;\r\n    }\r\n    let index = x + this.width() * y;\r\n    let arrows = this._arrowCollisionMap[level];\r\n    let arrowLayer = this._arrowCollisionMapLayers[level];\r\n    let arrowValue = arrows.main[index];\r\n    \r\n    if(render && arrows[render]) {\r\n        arrowValue = arrows[render][index];\r\n    } else if(arrowLayer && arrowLayer.length > 0) {\r\n        for(let idx = 0; idx < arrowLayer.length; idx++) {\r\n            let layerId = arrowLayer[idx];\r\n            let layerData = this.tiledData.layers[layerId];\r\n            let hideData = TiledManager.checkLayerHidden(layerData, 'collisions');\r\n            if(!hideData[1]) {\r\n                arrowValue&= regionMap[layerId][index];\r\n            }\r\n        }\r\n    }\r\n\r\n    return (arrowValue & bit) > 0\r\n}\r\n\r\nGame_Map.prototype.renderPassage = function (x, y, bit, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    if(render && !this._arrowCollisionMap[level][render]) {\r\n        render = 'main';\r\n    }\r\n    return this.checkPassage(x, y, bit, render, level);\r\n}\r\n\r\nGame_Map.prototype.getPassageLayers = function(level) {\r\n    return this._arrowCollisionMapLayers[level].slice(0);\r\n}\r\n\r\nlet _isPassable = Game_Map.prototype.isPassable;\r\nGame_Map.prototype.isPassable = function (x, y, d, render = false, level = false) {\r\n    if (!this.isTiledMap()) {\r\n        return _isPassable.call(this, x, y, d);\r\n    }\r\n    if(level === false) {\r\n        level = this._currentMapLevel;\r\n    }\r\n\r\n    if(!this.checkPassage(x, y, (1 << (d / 2 - 1)) & 0x0f, render)) {\r\n        return false;\r\n    }\r\n    \r\n    let index = x + this.width() * y;\r\n    let collisionMap = this._collisionMap[level];\r\n    let collisionLayer = this._collisionMapLayers[level];\r\n    let collisionValue = collisionMap.main[index]\r\n    \r\n    if(render && collisionMap[render]) {\r\n        collisionValue = collisionMap[render][index];\r\n    } else if(collisionLayer && collisionLayer.length > 0) {\r\n        for(let idx = 0; idx < collisionLayer.length; idx++) {\r\n            let layerId = collisionLayer[idx];\r\n            let layerData = this.tiledData.layers[layerId];\r\n            let hideData = TiledManager.checkLayerHidden(layerData, 'collisions');\r\n            if(!hideData[1]) {\r\n                collisionValue|= collisionMap[layerId][index];\r\n            }\r\n        }\r\n    }\r\n\r\n    return collisionValue === 0;\r\n};\r\n\r\nGame_Map.prototype.renderIsPassable = function (x, y, d, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    if(render && !this._collisionMap[level][render]) {\r\n        render = 'main';\r\n    }\r\n    return this.isPassable(x, y, d, render, level);\r\n}\r\n\r\nGame_Map.prototype.getIsPassableLayers = function(level) {\r\n    return this._collisionMapLayers[level].slice(0);\r\n}\r\n\r\nGame_Map.prototype.checkMapLevelChanging = function (x, y) {\r\n    let mapLevelChange = this._mapLevelChange[this.currentMapLevel];\r\n    let mapLevelChangeLayer = this._mapLevelChangeLayers[this.currentMapLevel];\r\n    let index = y * this.width() + x;\r\n    let mapLevelChangeValue = mapLevelChange.main[index]\r\n    if(mapLevelChangeLayer.length > 0) {\r\n        for(let idx = 0; idx < mapLevelChangeLayer.length; idx++) {\r\n            let layerId = mapLevelChangeLayer[idx];\r\n            let layerData = this.tiledData.layers[layerId];\r\n            let hideData = TiledManager.checkLayerHidden(layerData, 'levelChanges');\r\n            if(!hideData[1]) {\r\n                mapLevelChangeValue = mapLevelChange[layerId][index];\r\n            }\r\n        }\r\n    }\r\n    if (mapLevelChangeValue < 0) {\r\n        return false;\r\n    }\r\n    this.currentMapLevel = mapLevelChangeValue;\r\n    return true;\r\n};\r\n\r\nGame_Map.prototype.checkPositionHeight = function (x, y) {\r\n    let positionHeightChange = this._positionHeightChange[this.currentMapLevel];\r\n    let positionHeightChangeLayer = this._positionHeightChangeLayers[this.currentMapLevel];\r\n    let index = y * this.width() + x;\r\n    let positionHeightChangeValue = positionHeightChange.main[index]\r\n    if(positionHeightChangeLayer.length > 0) {\r\n        for(let idx = 0; idx < positionHeightChangeLayer.length; idx++) {\r\n            let layerId = positionHeightChangeLayer[idx];\r\n            let layerData = this.tiledData.layers[layerId];\r\n            let hideData = TiledManager.checkLayerHidden(layerData, 'positionHeightChanges');\r\n            if(!hideData[1]) {\r\n                positionHeightChangeValue = positionHeightChange[layerId][index];\r\n            }\r\n        }\r\n    }\r\n    return positionHeightChangeValue;\r\n};\r\n\r\nGame_Map.prototype.getTileFlags = function (x, y, render = false, level = false) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    let index = x + this.width() * y;\r\n    let tileFlags = this._tileFlags[level];\r\n    let tileFlagsLayer = this._tileFlagsLayers[level];\r\n    let tileFlagsValue = (tileFlags.main[index] ? tileFlags.main[index].slice(0) : []);\r\n\r\n    if(render && tileFlags[render]) {\r\n        tileFlagsValue = (tileFlags[render][index] ? tileFlags[render][index].slice(0) : []);\r\n    } else if(tileFlagsLayer && tileFlagsLayer.length > 0) {\r\n        for(let idx = 0; idx < tileFlagsLayer.length; idx++) {\r\n            let layerId = tileFlagsLayer[idx];\r\n            let layerData = this.tiledData.layers[layerId];\r\n            let hideData = TiledManager.checkLayerHidden(layerData, 'tileFlags');\r\n            if(!hideData[1] && tileFlags[layerId][index]) {\r\n                tileFlagsValue[i] = this._combineFlags(tileFlagsValue[i], tileFlags[layerId][index])\r\n            }\r\n        }\r\n    }\r\n    return tileFlagsValue\r\n}\r\n\r\nGame_Map.prototype.renderTileFlags = function (x, y, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    if(render && !this._tileFlags[level][render]) {\r\n        render = 'main';\r\n    }\r\n    return this.getTileFlags(x, y, render, level);\r\n}\r\n\r\nGame_Map.prototype.checkHasTileFlag = function (x, y, flag, render = false, level = false) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    if(typeof flag === 'string') {\r\n        flag = TiledManager.getFlag(flag)\r\n    }\r\n    let bit = (1 << (flag % 16)) & 0xffff;\r\n    let group = Math.floor(flag / 16);\r\n    let tileFlagsValue = this.getTileFlags(x, y, render, level);\r\n    \r\n    return (tileFlagsValue[group] & bit) > 0\r\n}\r\n\r\nGame_Map.prototype.renderHasTileFlag = function (x, y, flag, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    if(render && !this._tileFlags[level][render]) {\r\n        render = 'main';\r\n    }\r\n    return this.checkHasTileFlag(x, y, flag, render, level);\r\n}\r\n\r\nlet _isBoatPassable = Game_Map.prototype.isBoatPassable\r\nGame_Map.prototype.isBoatPassable = function(x, y, render = false, level = false) {\r\n    if (!this.isTiledMap()) {\r\n        return _isBoatPassable.call(this, x, y);\r\n    }\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.checkHasTileFlag(x, y, 'boat', render, level);\r\n};\r\n\r\nGame_Map.prototype.renderIsBoatPassable = function(x, y, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isBoatPassable(x, y, render, level);\r\n}\r\n\r\nlet _isShipPassable = Game_Map.prototype.isShipPassable\r\nGame_Map.prototype.isShipPassable = function(x, y, render = false, level = false) {\r\n    if (!this.isTiledMap()) {\r\n        return _isShipPassable.call(this, x, y);\r\n    }\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.checkHasTileFlag(x, y, 'ship', render);\r\n};\r\n\r\nGame_Map.prototype.renderIsShipPassable = function(x, y, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isShipPassable(x, y, render, level);\r\n}\r\n\r\nlet _isAirshipLandOk = Game_Map.prototype.isAirshipLandOk\r\nGame_Map.prototype.isAirshipLandOk = function(x, y, render = false, level = false) {\r\n    if (!this.isTiledMap()) {\r\n        return _isAirshipLandOk.call(this, x, y);\r\n    }\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.checkHasTileFlag(x, y, 'airship', render) && this.checkPassage(x, y, 0x0f, render);\r\n};\r\n\r\nGame_Map.prototype.renderIsAirshipLandOk = function(x, y, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isAirshipLandOk(x, y, render, level);\r\n}\r\n\r\nlet _isLadder = Game_Map.prototype.isLadder\r\nGame_Map.prototype.isLadder = function(x, y, render = false, level = false) {\r\n    if (!this.isTiledMap()) {\r\n        return _isLadder.call(this, x, y);\r\n    }\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isValid(x, y) && this.checkHasTileFlag(x, y, 'ladder', render);\r\n};\r\n\r\nGame_Map.prototype.renderIsLadder = function(x, y, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isLadder(x, y, render, level);\r\n}\r\n\r\nlet _isBush = Game_Map.prototype.isBush\r\nGame_Map.prototype.isBush = function(x, y, render = false, level = false) {\r\n    if (!this.isTiledMap()) {\r\n        return _isBush.call(this, x, y);\r\n    }\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isValid(x, y) && this.checkHasTileFlag(x, y, 'bush', render);\r\n};\r\n\r\nGame_Map.prototype.renderIsBush = function(x, y, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isBush(x, y, render, level);\r\n}\r\n\r\nlet _isCounter = Game_Map.prototype.isCounter\r\nGame_Map.prototype.isCounter = function(x, y, render = false, level = false) {\r\n    if (!this.isTiledMap()) {\r\n        return _isCounter.call(this, x, y);\r\n    }\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isValid(x, y) && this.checkHasTileFlag(x, y, 'counter', render);\r\n};\r\n\r\nGame_Map.prototype.renderIsCounter = function(x, y, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isCounter(x, y, render, level);\r\n}\r\n\r\nlet _isDamageFloor = Game_Map.prototype.isDamageFloor\r\nGame_Map.prototype.isDamageFloor = function(x, y, render = false, level = false) {\r\n    if (!this.isTiledMap()) {\r\n        return _isDamageFloor.call(this, x, y);\r\n    }\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isValid(x, y) && this.checkHasTileFlag(x, y, 'damage', render);\r\n};\r\n\r\nGame_Map.prototype.renderIsDamageFloor = function(x, y, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isDamageFloor(x, y, render, level);\r\n}\r\n\r\nGame_Map.prototype.isSlipperyFloor = function(x, y, render = false, level = false) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isValid(x, y) && this.checkHasTileFlag(x, y, 'ice', render);\r\n};\r\n\r\nGame_Map.prototype.renderIsSlipperyFloor = function(x, y, render = 'main', level = 0) {\r\n    if(level === false) {\r\n        level = 0;\r\n    }\r\n    return this.isSlipperyFloor(x, y, render, level);\r\n}\r\n\r\nGame_Map.prototype.getLayerProperties = function(layer = -1, ignoreHidden = true) {\r\n\tif(layer > -1) {\r\n\t\tif(this.tiledData.layers[layer] && this.tiledData.layers[layer].properties) {\r\n\t\t\treturn Object.assign({}, this.tiledData.layers[layer].properties);\r\n\t\t}\r\n\t\treturn {};\r\n\t}\r\n\tlet layerProperties = {};\r\n\tthis.tiledData.layers.forEach((layerData, i) => {\r\n\t\tif(layerData && layerData.properties) {\r\n            if(!ignoreHidden || !TiledManager.checkLayerHidden(layerData, 'collisions')[1]) {\r\n                layerProperties[i] = Object.assign({}, layerData.properties);\r\n            }\r\n\t\t}\r\n\t});\r\n\treturn layerProperties;\r\n}\r\n\r\nGame_Map.prototype.getTileProperties = function(x, y, layer = -1, ignoreHidden = true) {\r\n    let index = x + this.width() * y;\r\n    \r\n\tif(layer > -1) {\r\n\t\tif(this.tiledData.layers[layer]) {\r\n\t\t\tlet tileId = this.tiledData.layers[layer].data[x];\r\n\t\t\tlet tileset = this._getTileset(tileId);\r\n\t\t\tif(tileset && tileset.tileproperties) {\r\n\t\t\t\treturn Object.assign({}, tileset.tileproperties[tileId - tileset.firstgid]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {};\r\n\t}\r\n\tlet tileProperties = {};\r\n\tthis.tiledData.layers.forEach((layerData, i) => {\r\n\t\tif(layerData && layerData.properties) {\r\n            if(!ignoreHidden || !TiledManager.checkLayerHidden(layerData)[1]) {\r\n                let props = this.getTileProperties(x, y, i);\r\n                if(Object.keys(props).length > 0) {\r\n                    tileProperties[i] = props;\r\n                }\r\n            }\r\n\t\t}\r\n\t});\r\n\treturn tileProperties;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Game_Map.js","let pluginParams = PluginManager.parameters(\"YED_Tiled\");\r\n\r\nGame_CharacterBase.prototype.screenZ = function () {\r\n    if (this._priorityType == 0) {\r\n        return parseInt(pluginParams[\"Z - Below Player\"]);\r\n    }\r\n    if (this._priorityType == 2) {\r\n        return parseInt(pluginParams[\"Z - Above Player\"]);\r\n    }\r\n    return parseInt(pluginParams[\"Z - Player\"]);\r\n};\r\n\r\nlet _distancePerFrame = Game_CharacterBase.prototype.distancePerFrame;\r\nGame_CharacterBase.prototype.distancePerFrame = function () {\r\n    let distance = _distancePerFrame.call(this);\r\n    return distance * (48 / Math.min($gameMap.tileWidth(), $gameMap.tileHeight()));\r\n};\r\n\r\nlet _refreshBushDepth = Game_CharacterBase.prototype.refreshBushDepth;\r\nGame_CharacterBase.prototype.refreshBushDepth = function() {\r\n    this._bushDepth = 0;\r\n    if(!$gameMap.isTiledMap() || $gameMap.isTiledInitialized()) {\r\n        _refreshBushDepth.call(this);\r\n    } else {\r\n        $gameMap.setRefreshDepth(this);\r\n    }\r\n};\r\n\r\nlet _updateMove = Game_CharacterBase.prototype.updateMove;\r\nGame_CharacterBase.prototype.updateMove = function() {\r\n    var hori = (this._realX > this._x ? 4 : (this._realX < this._x ? 6 : 0))\r\n    var vert = (this._realY > this._y ? 8 : (this._realY < this._y ? 2 : 0))\r\n    var d = hori + vert\r\n    _updateMove.call(this);\r\n    if(!this.isMoving() || pluginParams[\"Position Height - Always Check On Move Update\"].toLowerCase() === \"true\") {\r\n        let newLocationHeight = $gameMap.checkPositionHeight(this._x, this._y);\r\n        if(newLocationHeight > -1) {\r\n            this._locationHeight = newLocationHeight;\r\n        }\r\n    }\r\n    if(!this.isMoving() && $gameMap.isSlipperyFloor(this._x, this._y)) {\r\n        TiledManager.triggerListener(this, 'slipperyfloor', {\r\n            d\r\n        })\r\n    }\r\n}\r\n\r\nGame_CharacterBase.prototype.locationHeight = function() {\r\n\treturn this._locationHeight || 0\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Game_CharacterBase.js"],"sourceRoot":""}